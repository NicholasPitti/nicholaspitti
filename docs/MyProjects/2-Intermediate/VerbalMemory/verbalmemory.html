<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="">
        <!--while loop was creating infinite loop and freezing the tab-->
        <!--tricky because console wont tell you-->
        <!--decoupled showing new word and adding new word to seenArray-->
        <!-- == || === gives boolean result from comparison-->
                <!--index 0 of seen array was matching w/ new array[generatedIndex] for some reason--> 
        <!--match="yes" => match="no" would undo the work; only checking  for matches is enough-->   
        <!--hard mode vs easy mode.. in easy mode the word that made you lose isnt added to seenArray-->   
        <!-- how would you use events and event handlers here?-->
        <!-- i couldnt make a lives on change html content event handler unless i make it an input text field..but then user would be able to change it..unless i put the input field off the visible page-->

    </head>
    <body>
        <header style="font-size:24px; text-align:center;">
            <b>Verbal Memory Test</b>
        </header>

        <p>LIVES: <b id="lives">3</b> </p>
        <p id="wordout">Start Game?</p>
        <button id="newBtn" onclick="pickedNew()">New</button>
        <button id="seenBtn" onclick="pickedSeen()">Seen</button>
        <br>
        <button id="startBtn" onclick="startGame()">Start</button>
        <button id="showBtn" onclick="displayResults()">Show Seen Words</button>
        <br>
        <textarea id="textArea">drag down</textarea>
        
        <footer>
            <i>
                <ol>
                    <b>Functions</b>
                    <li>convert text file into array</li>
                    <li>display new word</li>
                    <li>randomly show new or seen word and then display it</li>
                    <li>function to verify match between displayed word and seen words</li>
                    <li>add to seen array if the word is new</li>
                    <li>lives counter</li>
                    <li>show all seen words in a textarea after losing</li>
                    <li>startGame/endGame button enabling/disabling</li>
                    <li>clear seenArray on gameStart</li>
                    <li>clear and try again start game function</li>
                    <p>To be done</p>    
                    <li style="color:red;">displayed new word is blank at times</li>
                    <li style="color:red;">clear resuslts textbox and seenArray</li>
                    <li style="color:red;">full reset on seen list without having to reload page</li>
                    <li style="color:red;">add radio button for disabling seen words clearing on loss</li>
                    <li style="color:red;">fetch word api</li>
                    <li style="color:red;">buffer fetch x amount of words 25 easy mode,50 hard mode and fill new array</li>
                </ol>
            </i>
            <i>
                <ul>
                    <b>Concepts</b>
                    <li>enable and disable buttons</li>
                    <li>variable types, assignment, initialization & scope</li>
                    <li>decoupling functions</li>
                    <li>do while loops not advised</li>
                </ul>
            </i>
            <i>
                <ul>
                    <b>Rules as Limitations</b>
                    <li>html,js,json,</li>
                    <li>more than 10 functions</li>
                    <li>less than 500 lines of code</li>
                    <li>minimal libraries and frameworks</li>
                </ul>
            </i>            
        </footer>
    </body>
    <script>
    var newArray=[];
    var seenArray=[]; //var seenIndex=[]; not used //seenArray[0]="bruh"; //matching for some reason
    var generatedIndex=0;
    var lives=3;
    var probability=0;
    var randomSeenIndex=0;
    var match="no";
    var displayedWord=""; //sometimes this is counted ###
    var i;
    document.getElementById("showBtn").disabled=true;
    document.getElementById("newBtn").disabled=true;
    document.getElementById("seenBtn").disabled=true;
  
    getText("words.txt");
    async function getText(file) {
    let myObject = await fetch(file);
    let myText = await myObject.text(); //buffer preloaded words
    newArray=myText.split(","); //populate new array with entire text file
    }

    function startGame(){
        document.getElementById("showBtn").disabled=true;
        document.getElementById("newBtn").disabled=false;
        document.getElementById("seenBtn").disabled=false;
        document.getElementById("startBtn").disabled=true;
        document.getElementById("textArea").innerHTML="";
        /*
        if(document.getElementById("hardMode").checked){ //clears seen array and fully resets game
            for (i=0;i<seenArray.length;i++){
                seenArray.pop()
            }
        }
        */
        /////////
        for (i=0;i<seenArray.length;i++){
                seenArray.pop()
            }
        /////////
        lives=3;//restarting lives
        document.getElementById("lives").textContent=lives;//displaying lives after restart
        showNewWord();
    }

    function pickedNew(){
        seenArray.forEach(verifyWordMatch);
        console.log(match+"a4 checking");
        if (match=="yes"){ 
            lives=lives-1;
        } else{
            seenArray.push(displayedWord); //add displayed word to the seen words array
        }
        document.getElementById("lives").textContent=lives;
        showNewWord();
        endGameCheck();
    }

    function pickedSeen(){
        seenArray.forEach(verifyWordMatch);
        if (match=="no"){
            lives--;
            seenArray.push(displayedWord);
        }
        document.getElementById("lives").textContent=lives;
        showNewWord();        
        endGameCheck();
    }

    function verifyWordMatch(item,index){
        console.log("item-"+item);     
        if (item==displayedWord){
            match="yes";
        }              
    }
    
    function displayResults(){
        //seenArray.forEach(sliceQuotation);  /gets rid of output with quotations from text file
        document.getElementById("textArea").innerHTML=seenArray;
        document.getElementById("startBtn").disabled=false;
    }        

    function sliceQuotation(item,index){ //cleans up quatation marks from results textbox
        seenArray[index]=seenArray[index].slice(1,-1);
    }
    
    function showNewWord(){
        match="no";
        probablility=Math.floor(Math.random()*4);//arbitrary probability can be fine tuned to show seen words more often
        console.log("seenarray length--"+seenArray.length)
            if(probablility<1 && seenArray.length>1){
                randomSeenIndex=Math.floor(Math.random()*seenArray.length);
                displayedWord=seenArray[randomSeenIndex];
            //} else if(probablility>=1){
            } else {
            generatedIndex=Math.floor(Math.random()*99);
            displayedWord=newArray[generatedIndex];
            }
        document.getElementById("wordout").textContent =displayedWord;
        console.log("----------"+displayedWord);
    }
    
    function endGameCheck(){
        if(lives==0){
            document.getElementById("showBtn").disabled=false;
            document.getElementById("newBtn").disabled=true;
            document.getElementById("seenBtn").disabled=true;
        }  
    }

    </script>

</html>